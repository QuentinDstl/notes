import{O as A,P as D,Q as m,R as L,p as E,S as R,h as g,z as M,T as k,U as w,q as B,V as N,W as Y,X as x,Y as F,Z as U,y as C,x as T,_ as q,a0 as z,a1 as Z,f as S,a2 as $,s as G,a3 as H,a4 as Q,a5 as V,a as W,a6 as X,a7 as j,a8 as J,a9 as K,aa as ee,b as te,o as ae,ab as se,ac as re}from"./jZipquqU.js";import{c as ie}from"./BNW1UFmq.js";class ne{anchor;#t=new Map;#a=new Map;#e=new Map;#s=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#i=()=>{var e=A;if(this.#t.has(e)){var a=this.#t.get(e),t=this.#a.get(a);if(t)D(t),this.#s.delete(a);else{var n=this.#e.get(a);n&&(this.#a.set(a,n.effect),this.#e.delete(a),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),t=n.effect)}for(const[s,i]of this.#t){if(this.#t.delete(s),s===e)break;const r=this.#e.get(i);r&&(m(r.effect),this.#e.delete(i))}for(const[s,i]of this.#a){if(s===a||this.#s.has(s))continue;const r=()=>{if(Array.from(this.#t.values()).includes(s)){var h=document.createDocumentFragment();k(i,h),h.append(E()),this.#e.set(s,{effect:i,fragment:h})}else m(i);this.#s.delete(s),this.#a.delete(s)};this.#r||!t?(this.#s.add(s),L(i,r,!1)):r()}}};#n=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[t,n]of this.#e)a.includes(t)||(m(n.effect),this.#e.delete(t))};ensure(e,a){var t=A,n=w();if(a&&!this.#a.has(e)&&!this.#e.has(e))if(n){var s=document.createDocumentFragment(),i=E();s.append(i),this.#e.set(e,{effect:R(()=>a(i)),fragment:s})}else this.#a.set(e,R(()=>a(this.anchor)));if(this.#t.set(t,e),n){for(const[r,f]of this.#a)r===e?t.skipped_effects.delete(f):t.skipped_effects.add(f);for(const[r,f]of this.#e)r===e?t.skipped_effects.delete(f.effect):t.skipped_effects.add(f.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else g&&(this.anchor=M),this.#i()}}function de(d,e,a=!1){g&&N();var t=new ne(d),n=a?Y:0;function s(i,r){if(g){const h=x(d)===F;if(i===h){var f=U();C(f),t.anchor=f,T(!1),t.ensure(i,r),T(!0);return}}t.ensure(i,r)}B(()=>{var i=!1;e((r,f=!0)=>{i=!0,s(f,r)}),i||s(!1,null)},n)}function he(d,e,a,t){var n=!W||(a&X)!==0,s=(a&j)!==0,i=(a&re)!==0,r=t,f=!0,h=()=>(f&&(f=!1,r=i?te(t):t),r),_;if(s){var I=K in d||ee in d;_=q(d,e)?.set??(I&&e in d?c=>d[e]=c:void 0)}var o,p=!1;s?[o,p]=ie(()=>d[e]):o=d[e],o===void 0&&t!==void 0&&(o=h(),_&&(n&&z(),_(o)));var u;if(n?u=()=>{var c=d[e];return c===void 0?h():(f=!0,c)}:u=()=>{var c=d[e];return c!==void 0&&(r=void 0),c===void 0?r:c},n&&(a&Z)===0)return u;if(_){var O=d.$$legacy;return(function(c,v){return arguments.length>0?((!n||!v||O||p)&&_(v?u():c),c):u()})}var b=!1,l=((a&se)!==0?ae:V)(()=>(b=!1,u()));s&&S(l);var y=H;return(function(c,v){if(arguments.length>0){const P=v?S(l):n&&s?$(c):c;return G(l,P),b=!0,r!==void 0&&(r=P),c}return J&&b||(y.f&Q)!==0?l.v:S(l)})}export{ne as B,de as i,he as p};
