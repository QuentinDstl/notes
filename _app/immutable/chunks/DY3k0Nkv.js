import{K as A,L as D,M as m,N as L,j as E,O as R,o as g,x as M,P as k,Q as w,k as N,R as B,S as Y,T as x,U as F,V as U,w as C,v as T,W as Z,X as $,g as S,Y as j,s as q,Z as z,_ as G,a0 as H,a as K,a1 as Q,a2 as V,a3 as W,a4 as X,a5 as J,i as ee,b as te,a6 as se,a7 as ae,a8 as re}from"./DTMw8plr.js";import{c as ie}from"./gjXtdPSg.js";class ne{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,s=!0){this.anchor=e,this.#r=s}#i=()=>{var e=A;if(this.#t.has(e)){var s=this.#t.get(e),t=this.#s.get(s);if(t)D(t),this.#a.delete(s);else{var n=this.#e.get(s);n&&(this.#s.set(s,n.effect),this.#e.delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),t=n.effect)}for(const[a,i]of this.#t){if(this.#t.delete(a),a===e)break;const r=this.#e.get(i);r&&(m(r.effect),this.#e.delete(i))}for(const[a,i]of this.#s){if(a===s||this.#a.has(a))continue;const r=()=>{if(Array.from(this.#t.values()).includes(a)){var h=document.createDocumentFragment();k(i,h),h.append(E()),this.#e.set(a,{effect:i,fragment:h})}else m(i);this.#a.delete(a),this.#s.delete(a)};this.#r||!t?(this.#a.add(a),L(i,r,!1)):r()}}};#n=e=>{this.#t.delete(e);const s=Array.from(this.#t.values());for(const[t,n]of this.#e)s.includes(t)||(m(n.effect),this.#e.delete(t))};ensure(e,s){var t=A,n=w();if(s&&!this.#s.has(e)&&!this.#e.has(e))if(n){var a=document.createDocumentFragment(),i=E();a.append(i),this.#e.set(e,{effect:R(()=>s(i)),fragment:a})}else this.#s.set(e,R(()=>s(this.anchor)));if(this.#t.set(t,e),n){for(const[r,f]of this.#s)r===e?t.skipped_effects.delete(f):t.skipped_effects.add(f);for(const[r,f]of this.#e)r===e?t.skipped_effects.delete(f.effect):t.skipped_effects.add(f.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else g&&(this.anchor=M),this.#i()}}function de(d,e,s=!1){g&&B();var t=new ne(d),n=s?Y:0;function a(i,r){if(g){const h=x(d)===F;if(i===h){var f=U();C(f),t.anchor=f,T(!1),t.ensure(i,r),T(!0);return}}t.ensure(i,r)}N(()=>{var i=!1;e((r,f=!0)=>{i=!0,a(f,r)}),i||a(!1,null)},n)}function he(d,e,s,t){var n=!K||(s&Q)!==0,a=(s&V)!==0,i=(s&re)!==0,r=t,f=!0,h=()=>(f&&(f=!1,r=i?te(t):t),r),_;if(a){var I=X in d||J in d;_=Z(d,e)?.set??(I&&e in d?c=>d[e]=c:void 0)}var o,P=!1;a?[o,P]=ie(()=>d[e]):o=d[e],o===void 0&&t!==void 0&&(o=h(),_&&(n&&se(),_(o)));var u;if(n?u=()=>{var c=d[e];return c===void 0?h():(f=!0,c)}:u=()=>{var c=d[e];return c!==void 0&&(r=void 0),c===void 0?r:c},n&&(s&$)===0)return u;if(_){var O=d.$$legacy;return(function(c,v){return arguments.length>0?((!n||!v||O||P)&&_(v?u():c),c):u()})}var b=!1,l=((s&ae)!==0?ee:H)(()=>(b=!1,u()));a&&S(l);var y=z;return(function(c,v){if(arguments.length>0){const p=v?S(l):n&&a?j(c):c;return q(l,p),b=!0,r!==void 0&&(r=p),c}return W&&b||(y.f&G)!==0?l.v:S(l)})}export{ne as B,de as i,he as p};
